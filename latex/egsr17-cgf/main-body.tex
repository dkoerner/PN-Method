% ---------------------------------------------------------------------
% EG author guidelines plus sample file for EG publication using LaTeX2e input
% D.Fellner, v2.02, Jan 25, 2017


\title[Draft]%
{
%Evaluation of Higher Order Diffusion against Variable Eddington Factor Methods for Rendering Participating Media
$P_N$-Method for Multiple Scattering in Participating Media
}

% for anonymous conference submission please enter your SUBMISSION ID
% instead of the author's name (and leave the affiliation blank) !!
%\author[D. Fellner \& S. Behnke]
%{\parbox{\textwidth}{\centering D.\,W. Fellner\thanks{Chairman Eurographics Publications Board}$^{1,2}$
%        and S. Behnke$^{2}$ 
%        S. Spencer$^2$\thanks{Chairman Siggraph Publications Board}
%        }
%        \\
%% For Computer Graphics Forum: Please use the abbreviation of your first name.
%{\parbox{\textwidth}{\centering $^1$TU Darmstadt \& Fraunhofer IGD, Germany\\
%         $^2$Graz University of Technology, Institute of Computer Graphics and Knowledge Visualization, Austria
%%        $^2$ Another Department to illustrate the use in papers from authors
%%             with different affiliations
%       }
%}
%}

\author
{
Compiled on \today
%David Koerner$^{1,2,3}$
%\qquad Jan Nov\'ak$^{1}$
%\qquad Peter Kutz$^{2}$
%\qquad Ralf Habel$^{2}$
%\qquad Wojciech Jarosz$^{1,4}$
\\
% For Computer Graphics Forum: Please use the abbreviation of your first name.
%$^1$Disney Research
%\qquad $^2$Walt Disney Animation Studios
%\qquad $^3$University of Stuttgart
%\qquad $^4$Dartmouth College
}


% ------------------------------------------------------------------------

% if the Editors-in-Chief have given you the data, you may uncomment
% the following five lines and insert it here
%
% \volume{36}   % the volume in which the issue will be published;
% \issue{1}     % the issue number of the publication
% \pStartPage{1}      % set starting page


%-------------------------------------------------------------------------
\begin{document}
% uncomment for using teaser
\teaser
{
\centering
\begin{subfigure}{0.24\linewidth}
%\missingfigure{}
\includegraphics[width=\linewidth]{images/nebulae_ms_cda.png}
\vspace{-0.17in}
\caption{Classical diffusion}
\label{fig:teaser_cda}
\end{subfigure}%
\hspace{0.002\linewidth}
\begin{subfigure}{0.24\linewidth}
\includegraphics[width=\linewidth]{images/nebulae_ms_p5.png}
\vspace{-0.17in}
\caption{$P_5$ (ours)}
\label{fig:nebulae_ours}
\label{fig:teaser_pn}
\end{subfigure}%
\hspace{0.002\linewidth}
\begin{subfigure}{0.24\linewidth}
%\missingfigure{}
\includegraphics[width=\linewidth]{images/nebulae_ms_fld.png}
\vspace{-0.17in}
\caption{Flux-limited diffusion}
\label{fig:teaser_fld}
\end{subfigure}%
\hspace{0.002\linewidth}
\begin{subfigure}{0.24\linewidth}
%\missingfigure{}
\includegraphics[width=\linewidth]{images/nebulae_ms_groundtruth.png}
\vspace{-0.17in}
\caption{Ground truth}
\label{fig:teaser_gt}
\end{subfigure}%
%\includegraphics[width=\linewidth]{figures/eg_new}
\vspace{-0.1in}
\icaption
{
Flux-limited diffusion (\subref{fig:teaser_fld}) is an ad-hoc extension to the classical diffusion approximation (\subref{fig:teaser_cda}). It can be considered the state of the art among deterministic methods for simulating light transport in highly scattering participating media, which is a common challenge for brute-force path tracing (\subref{fig:teaser_gt}). We add the $P_N$-method (\subref{fig:teaser_pn}) to the toolbox of deterministic methods in rendering and investigate its benefits and tradeoffs against flux-limited diffusion.
}
\label{fig:teaser}
}

\maketitle



%-------------------------------------------------------------------------

\begin{abstract}
%Classical diffusion approximation (CDA) is very competitive for rendering highly scattering participating media, because in these scenarios, Monte Carlo based methods suffer from high computational cost. Variable Eddington Factor methods, such as flux-limited diffusion (FLD), have shown to further improve the results from CDA. In this paper, we look at CDA as a degenerate case of the $P_1$-method and investigate the open question, if going higher order gives a viable alternative to FLD. We derive the time-independent real-valued $P_N$-equations and introduce a framework for generating finite difference stencils directly from the computer algebra representation of the $P_N$-equations for arbitrary order. We further present a staggered-grid $P_N$-solver and compare it against FLD for various standard problems.
Rendering highly scattering participating media is a common challenge for brute-force path tracing. Classical diffusion approximation is a competitive alternative, as it reduces the problem to solving a simple diffusion equation. Extensions, such as flux-limited diffusion, improve the former by switching to a non-linear diffusion coefficient. Both methods are based on the spherical harmonics expansion of the radiance field, truncated after the first order. In this paper, we investigate the open question of wether higher orders provide a viable alternative to these two approaches. Increasing the order introduces a set of increasingly complex coupled partial differential equations, whose growing number and complexity make them very difficult to work with. We introduce a computer algebra framework for representing and manipulating the underlying mathematical equations and use it to derive the time-independent real-valued $P_N$-equations for arbitrary orders. We further present a staggered-grid $P_N$-solver and generate its stencil code directly from the expression tree of the $P_N$-equations. Finally, we discuss how our method compares against prior work for various standard problems. We will release our computer algebra system, solver, and data as open source to ensure full reproducibility of all of our results.
%\begin{classification} % according to http://www.acm.org/class/1998/
%\CCScat{Computer Graphics}{I.3.7}{Three-Dimensional Graphics and Realism}{Raytracing}
%\end{classification}
\end{abstract}



%-------------------------------------------------------------------------
\input{introduction.tex}

%-------------------------------------------------------------------------

\input{previous_work.tex}

%-------------------------------------------------------------------------
\input{section_discretized_rte.tex}
\input{section_car.tex}
\input{section_real_valued_pn_equations.tex}

%-------------------------------------------------------------------------
\input{solver.tex}

%-------------------------------------------------------------------------
\input{rendering.tex}

%-------------------------------------------------------------------------
\input{results.tex}

%-------------------------------------------------------------------------
\input{conclusion.tex}


%-------------------------------------------------------------------------

\bibliographystyle{eg-alpha}
%\bibliographystyle{eg-alpha-doi}

\bibliography{bibliography}

%-------------------------------------------------------------------------
%\newpage



\end{document}
