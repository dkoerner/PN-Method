\section{Introduction}

Simulating light transport in paticipating media is still a challenging problem for image synthesis in computer graphics. Monte Carlo based techniques are established as the standard approach, because they can produce unbiased results and are conceptionally easy to implement. They become computationally demanding however, for participating media, which exhibits strong scattering or anisotropy.

Deterministic methods on the other hand are unpopular. This is because they suffer from discretization artifacts, produce biased results, cannot be coupled easily with surface rendering problems and are trickier to implement. However, their appeal lies in the fact that they have better performance for certain problems and produce a global solution across the whole domain.

The work on path guiding techniques from recent years has shown, how discretized approximate representations of the correct solution can be used to accelerate Monte Carlo integration techniques, such as path tracing. Instead of generating these approximate representations using correct methods, deterministic methods may offer a viable alternative and pave the way for hybrid methods, which combine the performance benefits of deterministic methods with correct and exact Monte Carlo techniques. Further, deterministic methods lend themselfs to applications, where a fast approximate solution is often preferred over correct, but slowly converging results. Under this light, it is important to study deterministic methods and have a solid understanding about their characteristics and performance traits for typical rendering problems.

The $P_N$-method is a deterministic method, which is popular in other fields like medical imaging and nuclear sciences, but has not been explored for applications in graphics yet. The purpose and main contribution of our paper is, to gain a solid understanding of its foundations and present a method for application in rendering. In particular, we present the following theoretical and practical contributions:
\begin{itemize}
	\item We derive and present the time-independent real-valued $P_N$-equations.
	\item We introduce a staggered-grid solver, for which we generate stencil code automatically from a computer algebra representation of the $P_N$-equations. This allows us to deal with the increasingly complex equations, which the $P_N$-method produces for higher order. It further allows our solver to be used for any (potentially coupled) partial differential equation, which results in a system of linear equations after discretization.
	\item Finally, we compare the $P_N$-method for higher orders against flux-limited diffusion, and answer the long standing question about which approach should be preferred.
\end{itemize}

In the next section, we will discuss related work and why it motivates our contribution. Section~\ref{sec:pnequations} introduces the real-valued $P_N$-equations, which we solve using our solver described in section~\ref{sec:pnsolver}. We explain in section~\ref{sec:rendering}, how the solution is being applied in a rendering application. Our $P_N$-solver is run and compared against flux-limited diffusion for a set of standard problems in section~\ref{sec:results}. We finish with our conclusion in section~\ref{sec:conclusion}.